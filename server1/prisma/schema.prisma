// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id       Int    @id @default(autoincrement())
  username String @unique
  password String
}

model ClinicalService {
  id       Int      @id @default(autoincrement())
  title    String
  tagline  String
  overview String
  features String[]
  image    Json

  testimonial Testimonial[] @relation("ClinicalServiceTestimonials")

  contactId Int
  contact   ContactInfo @relation(fields: [contactId], references: [id])

  doctors         Doctor[]          @relation("ClinicalServiceDoctors")
  relatedServices RelatedService[]  @relation("ClinicalServiceRelated")
  clinics         ClinicalService[] @relation("SubClinics")
  parentClinic    ClinicalService?  @relation("SubClinics", fields: [parentClinicId], references: [id])
  parentClinicId  Int?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Doctor {
  id    Int    @id @default(autoincrement())
  name  String
  title String
  image String
  bio   String

  clinicalServiceId Int
  clinicalService   ClinicalService @relation("ClinicalServiceDoctors", fields: [clinicalServiceId], references: [id])
}

model ContactInfo {
  id               Int               @id @default(autoincrement())
  phone            String
  emails           EmailEntry[]
  clinicalServices ClinicalService[]
}

model EmailEntry {
  id            Int         @id @default(autoincrement())
  type          String
  address       String
  contactInfoId Int
  contactInfo   ContactInfo @relation(fields: [contactInfoId], references: [id])
}

model Testimonial {
  id    Int     @id @default(autoincrement())
  name  String
  title String
  image String?
  quote String

  clinicalServiceId Int?
  clinicalService   ClinicalService? @relation("ClinicalServiceTestimonials", fields: [clinicalServiceId], references: [id]  onDelete: SetNull)
}

model RelatedService {
  id          Int     @id @default(autoincrement())
  title       String
  description String?
  image       String
  imageAlt    String?
  link        String?

  clinicalServiceId Int
  clinicalService   ClinicalService @relation("ClinicalServiceRelated", fields: [clinicalServiceId], references: [id])
}
